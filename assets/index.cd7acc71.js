var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a,i=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&o(e,s,t[s]);if(a)for(var s of a(t))l.call(t,s)&&o(e,s,t[s]);return e},n=(e,a)=>t(e,s(a));import{i as c,r as d,a as p,o as u,b as y,c as m,d as v,e as _,u as f,t as g,f as b,n as x,g as h,p as w,h as k,j as A,k as T,F as S,l as O,m as j,q as N,s as M,v as E,w as z}from"./vendor.f4b4a17d.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var B=(e,t)=>{for(const[s,a]of t)e[s]=a;return e};const I=["data-element"],C=[(e=>(w("data-v-d87821d0"),e=e(),k(),e))((()=>_("div",{class:"sg-element__icon"},[_("div",{class:"sg-element__icon-spark"}),_("div",{class:"sg-element__icon-core"})],-1)))],P={key:0,class:"sg-element__title"};var D=B({props:{item:Object,className:String},setup(e){const t=c("audio"),s=d(null);let a=p({isMoving:!1});u((function(){y(s.value).draggable({inertia:!0,autoScroll:!0,listeners:{start:r,move:l,end:o}})}));const r=()=>{t.play("element-pickup")},l=e=>{var t=e.target,s=(parseFloat(t.getAttribute("data-x"))||0)+e.dx,r=(parseFloat(t.getAttribute("data-y"))||0)+e.dy;t.style.transform="translate("+s+"px, "+r+"px)",t.setAttribute("data-x",s),t.setAttribute("data-y",r),a.isMoving=!0};function o(){s.value.style.transform="translate(0px, 0px)",s.value.setAttribute("data-x",0),s.value.setAttribute("data-y",0),a.isMoving=!1,t.play("element-drop"),a.isMoving=!1}return(t,r)=>(m(),v("div",{class:x(`${e.className} sg-element`),style:h({"--primary":e.item.colors.primary,"--secondary":e.item.colors.secondary})},[_("div",{ref:(e,t)=>{t.orb=e,s.value=e},"data-element":e.item.id,class:"sg-element__orb"},C,8,I),f(a).isMoving?b("",!0):(m(),v("div",P,g(e.item.label),1))],6))}},[["__scopeId","data-v-d87821d0"]]);const F=["data-element"],L=[(e=>(w("data-v-4ee58c7f"),e=e(),k(),e))((()=>_("div",{class:"sg-source__icon"},[_("div",{class:"sg-source__icon-core"})],-1)))],q={key:0,class:"sg-source__title"};var K=B({props:{item:Object,className:String},setup(e){const t=d(null);let s=p({isMoving:!1});u((function(){y(t.value).draggable({inertia:!0,autoScroll:!0,listeners:{move:a,end:r}})}));const a=e=>{var t=e.target,a=(parseFloat(t.getAttribute("data-x"))||0)+e.dx,r=(parseFloat(t.getAttribute("data-y"))||0)+e.dy;t.style.transform="translate("+a+"px, "+r+"px)",t.setAttribute("data-x",a),t.setAttribute("data-y",r),s.isMoving=!0};function r(){t.value.style.transform="translate(0px, 0px)",t.value.setAttribute("data-x",0),t.value.setAttribute("data-y",0),s.isMoving=!1,s.isMoving=!1}return(a,r)=>(m(),v("div",{class:x(`${e.className} sg-source`),style:h({"--primary":e.item.colors.primary,"--secondary":e.item.colors.secondary})},[_("div",{ref:(e,s)=>{s.orb=e,t.value=e},"data-element":e.item.id,class:"sg-source__orb"},L,8,F),f(s).isMoving?b("",!0):(m(),v("div",q,g(e.item.label),1))],6))}},[["__scopeId","data-v-4ee58c7f"]]);const R=e=>(w("data-v-530794ca"),e=e(),k(),e),$={class:"spell-menu"},G={class:"spell-menu__bar"},H={key:0,class:"spell-menu__wrapper"},V=R((()=>_("div",{class:"spell-menu__title"},"Элементы",-1))),X={class:"spell-menu__container"},J={key:1,class:"spell-menu__wrapper"},Q=R((()=>_("div",{class:"spell-menu__title"},"Источники силы",-1))),U={class:"spell-menu__container"},W={key:2,class:"spell-menu__wrapper"},Y=[R((()=>_("div",{class:"spell-menu__title"},"Базы",-1))),R((()=>_("div",{class:"spell-menu__container"},null,-1)))],Z={key:3,class:"spell-menu__wrapper"},ee=[R((()=>_("div",{class:"spell-menu__title"},"Формы",-1))),R((()=>_("div",{class:"spell-menu__container"},null,-1)))];var te=B({setup(e){const t=A(),s=T((()=>t.state.elements)),a=T((()=>t.state.sources));let r=p({activeTab:0});return(e,t)=>(m(),v("div",$,[_("div",G,[_("div",{class:x(["spell-menu__bar-item",{active:0===f(r).activeTab}]),onClick:t[0]||(t[0]=e=>f(r).activeTab=0)}," Элементы ",2),_("div",{class:x(["spell-menu__bar-item",{active:1===f(r).activeTab}]),onClick:t[1]||(t[1]=e=>f(r).activeTab=1)}," Источники ",2),_("div",{class:x(["spell-menu__bar-item",{active:2===f(r).activeTab}]),onClick:t[2]||(t[2]=e=>f(r).activeTab=2)}," Базы ",2),_("div",{class:x(["spell-menu__bar-item",{active:3===f(r).activeTab}]),onClick:t[3]||(t[3]=e=>f(r).activeTab=3)}," Формы ",2)]),0===f(r).activeTab?(m(),v("div",H,[V,_("div",X,[(m(!0),v(S,null,O(f(s),(e=>(m(),j(D,{className:"spell-menu__item",item:e,key:e.id},null,8,["item"])))),128))])])):b("",!0),1===f(r).activeTab?(m(),v("div",J,[Q,_("div",U,[(m(!0),v(S,null,O(f(a),(e=>(m(),j(K,{className:"spell-menu__item",item:e,key:e.id},null,8,["item"])))),128))])])):b("",!0),2===f(r).activeTab?(m(),v("div",W,Y)):b("",!0),3===f(r).activeTab?(m(),v("div",Z,ee)):b("",!0)]))}},[["__scopeId","data-v-530794ca"]]);const se=[N('<div class="sg-source__orbit" data-v-4bf5b4de></div><div class="sg-source__orbit" data-v-4bf5b4de></div><div class="sg-source__orbit" data-v-4bf5b4de></div><div class="sg-source__orbit" data-v-4bf5b4de></div><div class="sg-source__orbit" data-v-4bf5b4de></div><div class="sg-source__orbit" data-v-4bf5b4de></div><div class="sg-source__core" data-v-4bf5b4de></div>',7)];var ae=B({props:{source:Object},setup:e=>(t,s)=>(m(),v("div",{class:"sg-source",style:h({"--primary":e.source.colors.primary,"--secondary":e.source.colors.secondary})},se,4))},[["__scopeId","data-v-4bf5b4de"]]);const re=e=>(w("data-v-17b8b772"),e=e(),k(),e),le={class:"sg-base-rectangle"},oe={class:"sg-shape"},ie={viewBox:"0 0 66 75",xmlns:"http://www.w3.org/2000/svg"},ne=re((()=>_("line",{stroke:"#000",id:"bottom",y2:"56.19054",x2:"7.64329",y1:"56.19054",x1:"57.3046",fill:"transparent"},null,-1))),ce=re((()=>_("line",{stroke:"#000",id:"left",y2:"7.10303",x2:"31.62739",y1:"52.45008",x1:"6.40888",fill:"transparent"},null,-1))),de=re((()=>_("line",{stroke:"#000",id:"right",y2:"6.96996",x2:"35.15579",y1:"52.79588",x1:"59.51894",fill:"transparent"},null,-1))),pe=["fill"],ue=["fill"],ye=["fill"],me=[re((()=>_("line",{stroke:"#000",id:"left_synergy_1",y2:"5.60928",x2:"29.96236",y1:"16.51821",x1:"7.74418",fill:"transparent"},null,-1))),re((()=>_("line",{stroke:"#000",id:"left_synergy_2",y2:"52.17487",x2:"4.41656",y1:"21.83808",x1:"4.41656",fill:"transparent"},null,-1))),re((()=>_("ellipse",{id:"left_synergy_apex",ry:"3.41656",rx:"3.41656",cy:"18.08279",cx:"4.54796",stroke:"#000",fill:"transparent"},null,-1)))],ve=[re((()=>_("line",{stroke:"#000",id:"right_synergy_1",y2:"5.48875",x2:"36.69186",y1:"16.88917",x1:"58.77375",fill:"transparent"},null,-1))),re((()=>_("line",{stroke:"#000",id:"right_synergy_2",y2:"22.36126",x2:"61.97241",y1:"52.76498",x1:"61.97241",fill:"transparent"},null,-1))),re((()=>_("ellipse",{id:"right_synergy_apex",ry:"3.41656",rx:"3.41656",cy:"18.477",cx:"61.70959",stroke:"#000",fill:"transparent"},null,-1)))],_e=[re((()=>_("line",{stroke:"#000",id:"bottom_synergy_1",y2:"58.26159",x2:"58.12161",y1:"69.68313",x1:"36.46006",fill:"transparent"},null,-1))),re((()=>_("line",{stroke:"#000",id:"bottom_synergy_2",y2:"69.52565",x2:"30.35658",y1:"57.76771",x1:"7.25691",fill:"transparent"},null,-1))),re((()=>_("ellipse",{id:"bottom_synergy_apex",ry:"3.41656",rx:"3.41656",cy:"71.03942",cx:"33.5887",stroke:"#000",fill:"transparent"},null,-1)))],fe={class:"sg-source__wrapper"},ge=re((()=>_("svg",{viewBox:"0 0 100 100"},[_("path",{id:"curve-path",d:"M 0, 50 a 50,50 0 1,0 100,0 a 50,50 0 1,0 -100,0",fill:"transparent"}),_("text",null,[_("textPath",{"xlink:href":"#curve-path",startOffset:"0"}," onetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothreeonetwothree ")])],-1)));var be=B({setup(e){const t=A(),s=d(null),a=d(null),r=d(null),l=d(null),o=T((()=>t.state.base));function i(e){t.dispatch("dropElement",{apex:e.target.id,element:e.relatedTarget.dataset.element})}function n(e){t.dispatch("dropSource",{source:e.target.id,element:e.relatedTarget.dataset.element})}return u((()=>{y(s.value).dropzone({accept:".sg-element__orb",ondrop:i}),y(a.value).dropzone({accept:".sg-element__orb",ondrop:i}),y(r.value).dropzone({accept:".sg-element__orb",ondrop:i}),y(l.value).dropzone({accept:".sg-source__orb",ondrop:n}),t.dispatch("setActiveBase",{type:"triangle",apexes:[{id:"top_apex"},{id:"right_apex"},{id:"left_apex"}],synergies:[{id:"left_synergy_apex",parents:["top_apex","left_apex"]},{id:"right_synergy_apex",parents:["top_apex","right_apex"]},{id:"bottom_synergy_apex",parents:["left_apex","right_apex"]}],sources:[{id:"sourceDropzone"}]})})),(e,t)=>{var i,n,c,d,p,u,y,g,h,w,k,A,T,S,O,N,M,E,z;return m(),v("div",le,[_("div",oe,[(m(),v("svg",ie,[ne,ce,de,_("ellipse",{ref:(e,t)=>{t.topApex=e,s.value=e},id:"top_apex",ry:"3.41656",rx:"3.41656",cy:"4.41656",cx:"33.32589",stroke:"#000",fill:(null==(c=null==(n=null==(i=f(o).apexes)?void 0:i.top_apex)?void 0:n.element)?void 0:c.colors.primary)||"transparent"},null,8,pe),_("ellipse",{ref:(e,t)=>{t.leftApex=e,r.value=e},id:"left_apex",ry:"3.41656",rx:"3.41656",cy:"55.53351",cx:"4.41656",stroke:"#000",fill:(null==(u=null==(p=null==(d=f(o).apexes)?void 0:d.left_apex)?void 0:p.element)?void 0:u.colors.primary)||"transparent"},null,8,ue),_("ellipse",{ref:(e,t)=>{t.rightApex=e,a.value=e},id:"right_apex",ry:"3.41656",rx:"3.41656",cy:"56.05913",cx:"60.92116",stroke:"#000",fill:(null==(h=null==(g=null==(y=f(o).apexes)?void 0:y.right_apex)?void 0:g.element)?void 0:h.colors.primary)||"transparent"},null,8,ye),_("g",{class:x(["synergy left",{appear:null==(k=null==(w=f(o).synergies)?void 0:w.left_synergy_apex)?void 0:k.element}])},me,2),_("g",{class:x(["synergy right",{appear:null==(T=null==(A=f(o).synergies)?void 0:A.right_synergy_apex)?void 0:T.element}])},ve,2),_("g",{class:x(["synergy bottom",{appear:null==(O=null==(S=f(o).synergies)?void 0:S.bottom_synergy_apex)?void 0:O.element}])},_e,2)]))]),_("div",fe,[_("div",{class:"sg-source__dropzone",id:"sourceDropzone",ref:(e,t)=>{t.sourceDropzone=e,l.value=e}},[(null==(M=null==(N=f(o).sources)?void 0:N.sourceDropzone)?void 0:M.element)?(m(),j(ae,{key:0,source:null==(z=null==(E=f(o).sources)?void 0:E.sourceDropzone)?void 0:z.element},null,8,["source"])):b("",!0)],512),ge])])}}},[["__scopeId","data-v-17b8b772"]]);const xe={class:"spell-canvas"};var he=B({setup:e=>(e,t)=>(m(),v("div",{class:"spell-canvas__wrapper",ref:(e,t)=>{t.root=e}},[_("div",xe,[M(be)])],512))},[["__scopeId","data-v-218238ae"]]);const we={class:"container-fluid sg-wrapper"},ke={class:"row"},Ae={class:"col-8"},Te={class:"col-4"};var Se=B({setup:e=>(e,t)=>(m(),v("section",we,[_("div",ke,[_("div",Ae,[M(he)]),_("div",Te,[M(te)])])]))},[["__scopeId","data-v-6ad16ed0"]]);const Oe={setup(e){const t=A(),s=c("audio");return s.loaded.then((()=>{t.commit("loaded",{system:"audio",loaded:!0}),s.play("background",{loop:!0,volume:.05})})),(e,s)=>f(t).getters.isLoading?(m(),j(Se,{key:1})):(m(),j(Se,{key:0}))}};var je=E({state:{elements:[...[{id:"light",label:"Свет",colors:{primary:"#fff952",secondary:"#fffdbd"}},{id:"dark",label:"Тьма",colors:{primary:"#3c0078",secondary:"#290052"}},{id:"fire",label:"Огонь",colors:{primary:"#e34f00",secondary:"#e38400"}},{id:"water",label:"Вода",colors:{primary:"#006bbd",secondary:"#7ac5ff"}},{id:"air",label:"Ветер",colors:{primary:"#e0feff",secondary:"#edfeff"}},{id:"earth",label:"Земля",colors:{primary:"#914b00",secondary:"#784e22"}},{id:"electricity",label:"Молния",colors:{primary:"#ffd000",secondary:"#bdfdff"}}]],sources:[...[{id:"mana",label:"Мана",colors:{primary:"#0037c2",secondary:"#9ebaff"}},{id:"divine",label:"Божественная",colors:{primary:"#ffcb1f",secondary:"#ffedb3"}},{id:"demonic",label:"Демоническая",colors:{primary:"#780016",secondary:"#4a1d25"}},{id:"astral",label:"Астральная",colors:{primary:"#00c6d4",secondary:"#d885ff"}}]],bases:[{name:"Rectangle",type:"rectangle"}],loaded:{audio:!1},base:{type:"",source:null,apexes:{},synergies:{},sources:{}}},mutations:{loaded(e,{system:t,loaded:s}){e.loaded[t]=s},addElement(e,t){e.elements.push(t)},resetActiveBase(e){e.base={type:"",apexes:{},synergies:{},sources:{}}},setElementToApex(e,{apex:t,element:s}){let a=e.elements.find((e=>e.id===s));e.base.apexes[t].element=a},setElementToSynergy(e,{synergy:t,element:s}){e.base.synergies[t].element=s},setElementToSource(e,{source:t,element:s}){let a=e.sources.find((e=>e.id===s));e.base.sources[t].element=a}},getters:{isLoading:e=>e.loaded.audio,getSynergy:e=>e=>!1},actions:{setActiveBase({commit:e,state:t},s){e("resetActiveBase"),t.base.type=s.type,t.base.apexes=s.apexes.reduce(((e,t)=>n(i({},e),{[t.id]:n(i({},t),{element:null})})),{}),t.base.synergies=s.synergies.reduce(((e,t)=>n(i({},e),{[t.id]:n(i({},t),{element:null})})),{}),t.base.sources=s.sources.reduce(((e,t)=>n(i({},e),{[t.id]:n(i({},t),{element:null})})),{})},dropElement({commit:e,dispatch:t},{apex:s,element:a}){e("setElementToApex",{apex:s,element:a}),t("digestSynergies")},dropSource({commit:e,dispatch:t},{source:s,element:a}){e("setElementToSource",{source:s,element:a})},digestSynergies({commit:e,state:t}){Object.keys(t.base.synergies).forEach((s=>{var a,r;let l=t.base.synergies[s].parents,o=[t.base.apexes[l[0]],t.base.apexes[l[1]]];(null==(a=o[0])?void 0:a.element)&&(null==(r=o[1])?void 0:r.element)&&e("setElementToSynergy",{synergy:s,element:"red"})}))}}});class Ne{constructor(e,t){this.context=e,this.urls=t,this.buffer={},this.loaded=new Promise(((e,t)=>{this.resolve=e})),this.loadAll()}loadSound(e,t){let s=new XMLHttpRequest;s.open("get",e,!0),s.responseType="arraybuffer",s.onload=()=>{this.context.decodeAudioData(s.response,(e=>{this.buffer[t]=e,Object.keys(this.buffer).length==Object.keys(this.urls).length&&this.resolve()}))},s.send()}loadAll(){for(const e in this.urls)this.loadSound(this.urls[e],e)}getSoundByKey(e){return this.buffer[e]}}class Me{constructor(e,t,s){this.context=e,this.buffer=t,this.options=s}setup(){const{loop:e,volume:t}=this.options;this.gainNode=this.context.createGain(),this.source=this.context.createBufferSource(),this.source.buffer=this.buffer,this.source.connect(this.gainNode),this.gainNode.connect(this.context.destination),this.source.loop=e,isFinite(t)&&(this.gainNode.gain.value=t)}play(){return this.setup(),this.source.start(this.context.currentTime),this}stop(){return this.gainNode.gain.exponentialRampToValueAtTime(.001,this.context.currentTime+.5),this.source.stop(this.context.currentTime+.5),this}}class Ee{constructor(e){this._name="vue-audio",this._ctx=null,this.__tracklist={},this.initAudioContext(),this._buffer=new Ne(this._ctx,e),this.loaded=this._buffer.loaded}play(e,t={}){new Me(this._ctx,this._buffer.getSoundByKey(e),t).play()}initAudioContext(){try{this._ctx=new(window.AudioContext||window.webkitAudioContext)}catch(e){console.error(`${this._name}: Failed to initialize audio context`,e)}}}var ze={install:(e,t)=>{e.provide("audio",new Ee(t))}};const Be=z(Oe);Be.use(je),Be.use(ze,{"base-appear":"src/assets/sound/base-appear.wav","spell-generating":"src/assets/sound/spell-generating.wav","element-pickup":"src/assets/sound/element-pickup.wav","element-place-fail":"src/assets/sound/element-place-fail.wav","element-drop":"src/assets/sound/element-drop.wav",background:"src/assets/sound/background.mp3"}),Be.mount("#app");
